{% extends "resale_layout.html" %}
{% block body %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h1 class="h4 mb-0">Resale Dashboard</h1>
  <div class="d-flex gap-2">
    <span class="pill">Candidates: {{ summary.sellers_total|fmt_int }}</span>
    <span class="pill">Verified: {{ summary.verified_total|fmt_int }}</span>
    <span class="pill">Items: {{ summary.items_total|fmt_int }}</span>
  </div>
  <div class="ms-auto"></div>
  <a class="pill" href="/resale/sellers">Sellers ▶</a>
  <a class="pill" href="/resale/verified">Verified ▶</a>
  <a class="pill" href="/resale/items">Items ▶</a>
  </div>

<div class="row g-3">
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><strong>Top Sellers</strong></div>
      <div class="list-group list-group-flush">
        {% for r in top_sellers %}
        <a class="list-group-item list-group-item-action d-flex align-items-center gap-3" href="{{ r.get('seller_url') }}" target="_blank" rel="noopener">
          <div class="small text-muted">{{ loop.index }}</div>
          <div class="flex-fill">
            <div class="fw-semibold">{{ r.get('seller_id') }}</div>
            <div class="small text-muted">overseas {{ r.get('overseas_hits') }}/{{ r.get('n_items_sample') }} ({{ r.get('overseas_rate')|fmt_pct(0) }})</div>
          </div>
          <div class="badge bg-secondary-subtle text-dark">score {{ r.get('score')|fmt_float(2) }}</div>
        </a>
        {% else %}
        <div class="list-group-item text-muted">No sellers yet</div>
        {% endfor %}
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><strong>Top Items</strong></div>
      <div class="list-group list-group-flush">
        {% for r in top_items %}
        <div class="list-group-item">
          <div class="d-flex align-items-center gap-3">
            <img src="{{ r.get('yahoo_image') }}" style="width:64px;height:64px;object-fit:cover;border-radius:6px;border:1px solid var(--border)" onerror="this.style.visibility='hidden'">
            <div class="flex-fill">
              <a class="d-block fw-semibold" href="{{ r.get('yahoo_url') }}" target="_blank" rel="noopener">{{ r.get('yahoo_title') }}</a>
              <div class="small text-muted">score {{ r.get('score')|fmt_float(2) }} / profit {{ r.get('est_profit_jpy')|fmt_money }}</div>
            </div>
            {% if r.get('ae_url') %}
            <a href="{{ r.get('ae_url') }}" target="_blank" rel="noopener">
              <img src="{{ r.get('ae_image') }}" style="width:64px;height:64px;object-fit:cover;border-radius:6px;border:1px solid var(--border)" onerror="this.style.visibility='hidden'">
            </a>
            {% endif %}
          </div>
        </div>
        {% else %}
        <div class="list-group-item text-muted">No item matches yet</div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

