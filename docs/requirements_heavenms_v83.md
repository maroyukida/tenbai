# メイプルストーリー v83 ローカル検証用サーバー（HeavenMS）要件定義（ドラフト）

本書は、指定記事（https://liliummagnoria.blog.fc2.com/blog-entry-27.html）の内容を参考に、HeavenMS を用いた MapleStory v83 相当のローカル検証サーバー構築に関する要件を整理したドラフトです。実装手順ではなく「満たすべき条件」をまとめています。

## 1. 背景・目的

- 目的: MapleStory v83 の挙動を再現する HeavenMS サーバーを、個人の学習・検証用途でローカル構築し、基本機能（ログイン/キャラ作成/序盤クエスト）の動作確認を行う。
- 前提: HeavenMS は v83 の“クリーン”な再現志向で、初期導入時点でクエストが正常動作しやすいとされる。

## 2. スコープ

- 対象: ローカル環境構築、初期 DB 投入、サーバー起動、基本プレイ動作確認。
- 対象外: 公開/商用運用、クライアント配布・改変、著作物再配布、大規模改造（NPC/スクリプト/コマンド拡張詳細）。

## 3. 参照情報（出典）

- HeavenMS 公式リポジトリ（AGPL-3.0、Java 8 要件、注意事項、アーカイブ済み）。
- 指定ブログ記事（Windows + Java8 + MySQL での導入観点と所感）。

## 4. 前提・制約

### 法務/規約

- 個人・非商用・ローカル検証を前提。権利者の知財・各種規約・法令を遵守する（配布不可/外部公開なし）。

### 技術

- Java 8（推奨: 8u111）でのビルド・実行が前提。
- Windows ローカルでの構築を推奨（WampServer/MySQL クライアントの利用前提）。
- HeavenMS はアーカイブ済みであり、最新の保守性は保証されない。
- 一部実行物がアンチウイルスで誤検知される可能性あり。

### 構成

- DB: MySQL。初期スキーマ投入が必要（同梱 SQL）。
- IDE: NetBeans 等の Java IDE でのビルド想定（任意の IDE でも可）。

## 5. システム構成（論理）

- アプリ層: HeavenMS（Java 8 でビルド/実行）。
- データ層: MySQL（アカウント/キャラクター/クエスト等の初期スキーマ）。
- クライアント: v83 相当クライアント（入手/配布は本スコープ外）。
- ネットワーク: 完全ローカル検証（外部接続は対象外）。

## 6. 必須ソフトウェア要件（目安）

- OS: Windows 10/11（64bit 想定）。
- JDK: Java 8（JDK8/8u111 推奨）。
- IDE: NetBeans 8 系（他 IDE も可）。
- DB: MySQL（管理ツールとして MySQL Workbench 推奨）。
- ミドル: WampServer 等（ローカル MySQL 受け皿として）。

## 7. 機能要件（FR）

- アカウント管理: DB にアカウントを作成できる（初期は管理者がレコード登録）。
- 認証/セッション: ログイン→チャンネル接続→ログアウトが成功する。
- キャラクター作成: キャラ新規作成と初期スポーン（初心者マップ）が期待通り。
- クエスト: 序盤クエストの受注→進行→完了が正常動作。
- 起動/停止: サーバー起動/停止が可能（JDK パス整合、重大例外なし）。
- ログ: 起動、ログイン、クエスト進行のイベントログを確認可能。

## 8. 非機能要件（NFR）

- 性能: ログイン応答 ≤ 10 秒、チャンネル切替 ≤ 5 秒（ローカル目安）。
- 可用性: 連続稼働 1 時間で致命的障害がないこと。
- 保守性: セットアップ/設定差分/起動手順を README 化して再現性を確保。
- セキュリティ: 外部公開しない（FW で外部遮断）。機密情報は平文保管しない。
- 整合性: “クリーン v83” の挙動を優先し過剰改造を避ける。

## 9. データ要件

- 初期化: 同梱 SQL（例: database/drops など）を投入し整合性チェック。
- 操作: アカウント/キャラ/クエスト等の主要テーブルが参照・更新可能。
- バックアップ: 最低限、手動で DB スナップショット取得。

## 10. 運用・管理要件

- 起動/停止: スクリプトで手動起動・停止（JDK パスを環境に合わせ設定）。
- バックアップ: MySQL のバックアップ方針（最低: 手動スナップショット）。
- AV 対応: 誤検知に遭遇した場合の例外設定方針（自己責任で実施）。

## 11. 受入基準（サンプル）

- JDK8 でビルド成功、サーバープロセス起動とログ出力が正常。
- クライアントからローカル接続でログイン→キャラ作成→初心者マップ出現。
- 序盤クエストを 1 件以上完遂可能。
- 検証セッション中に致命的クラッシュなし（ログ上も重大例外なし）。

## 12. リスクと対応

- 保守性: リポジトリはアーカイブ済み→手順/設定を文書化し再現性担保。
- 法務: IP/規約侵害の恐れ→ローカル・非商用・配布不可を厳守。
- 依存差異: JDK/ツールの差異→推奨バージョン（JDK 8u111 等）を採用・記録。
- AV 誤検知: 例外設定は最小限に限定し、リスクを明示。

## 13. 作業アウトライン（参考・非手順）

環境準備（JDK8/IDE/MySQL/WampServer）→ DB 初期化 → HeavenMS ビルド → 起動確認 → 基本動作テスト。

## 14. 成果物

- セットアップ記録（環境情報・ビルドログ・設定差分）。
- 簡易運用ガイド（起動/停止・バックアップ）。
- テスト結果レポート（受入基準との突合）。

## 15. 変更管理

- 変更点（日時/担当/理由/影響範囲）を明記して履歴化（Git/ドキュメント）。

---

注: 本ドラフトは、指定記事の内容を参考にローカル検証前提で整理したものです。外部公開・配布・商用利用等は想定していません。適用にあたっては各種ライセンス・規約・法令を遵守してください。

